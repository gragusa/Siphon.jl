<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization &amp; Bayesian · Filthy.jl</title><meta name="title" content="Optimization &amp; Bayesian · Filthy.jl"/><meta property="og:title" content="Optimization &amp; Bayesian · Filthy.jl"/><meta property="twitter:title" content="Optimization &amp; Bayesian · Filthy.jl"/><meta name="description" content="Documentation for Filthy.jl."/><meta property="og:description" content="Documentation for Filthy.jl."/><meta property="twitter:description" content="Documentation for Filthy.jl."/><meta property="og:url" content="https://gragusa.github.io/Filthy.jl/stable/api/optimization.html"/><meta property="twitter:url" content="https://gragusa.github.io/Filthy.jl/stable/api/optimization.html"/><link rel="canonical" href="https://gragusa.github.io/Filthy.jl/stable/api/optimization.html"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Filthy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/getting_started.html">Getting Started</a></li><li><a class="tocitem" href="../tutorials/custom_models.html">Custom Models</a></li><li><a class="tocitem" href="../tutorials/dynamic_factor.html">Dynamic Factor Models</a></li><li><a class="tocitem" href="../tutorials/estimation_methods.html">Estimation Methods</a></li><li><a class="tocitem" href="../tutorials/transformations.html">Parameter Transformations</a></li><li><a class="tocitem" href="../tutorials/visualization.html">Visualization</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="core.html">Core Functions</a></li><li><a class="tocitem" href="dsl.html">DSL &amp; Templates</a></li><li><a class="tocitem" href="matrix_helpers.html">Matrix Helpers</a></li><li class="is-active"><a class="tocitem" href="optimization.html">Optimization &amp; Bayesian</a><ul class="internal"><li><a class="tocitem" href="#Optimization"><span>Optimization</span></a></li><li><a class="tocitem" href="#Parameter-Transformations"><span>Parameter Transformations</span></a></li><li><a class="tocitem" href="#Log-Density-Interface"><span>Log-Density Interface</span></a></li><li><a class="tocitem" href="#Prior-Distributions"><span>Prior Distributions</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href="optimization.html">Optimization &amp; Bayesian</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="optimization.html">Optimization &amp; Bayesian</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gragusa/Filthy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gragusa/Filthy.jl/blob/master/docs/src/api/optimization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimization-and-Bayesian"><a class="docs-heading-anchor" href="#Optimization-and-Bayesian">Optimization &amp; Bayesian</a><a id="Optimization-and-Bayesian-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-and-Bayesian" title="Permalink"></a></h1><p>This page documents functions for parameter estimation and Bayesian inference.</p><h2 id="Optimization"><a class="docs-heading-anchor" href="#Optimization">Optimization</a><a id="Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Filthy.DSL.optimize_ssm"><a class="docstring-binding" href="#Filthy.DSL.optimize_ssm"><code>Filthy.DSL.optimize_ssm</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">optimize_ssm(spec, y; method=Optim.LBFGS(), kwargs...)</code></pre><p>Optimize state-space model parameters using Optimization.jl.</p><p>Works in unconstrained parameter space using automatic differentiation for gradient computation.</p><p><strong>Arguments</strong></p><ul><li><code>spec::SSMSpec</code>: Model specification</li><li><code>y::AbstractMatrix</code>: Observations (p × n matrix)</li><li><code>method</code>: Optimization algorithm (default: L-BFGS)</li><li><code>θ0</code>: Initial parameter values (constrained). Default: <code>initial_values(spec)</code></li><li><code>ad_backend</code>: AD backend for gradients (default: <code>Optimization.AutoForwardDiff()</code>)</li><li><code>use_static::Bool=true</code>: Use StaticArrays for small matrices (dimensions ≤ 13)</li><li><code>prob_kwargs</code>: NamedTuple of kwargs passed to <code>OptimizationProblem</code></li><li><code>kwargs...</code>: All other kwargs passed to <code>Optimization.solve</code></li></ul><p><strong>Common solve kwargs</strong></p><ul><li><code>maxiters</code>: Maximum iterations (default: 1000)</li><li><code>maxtime</code>: Maximum time in seconds</li><li><code>abstol</code>: Absolute tolerance</li><li><code>reltol</code>: Relative tolerance</li><li><code>callback</code>: Callback function <code>(state, loss) -&gt; Bool</code> (return true to stop)</li><li><code>progress</code>: Show progress bar (requires ProgressLogging.jl)</li><li><code>show_trace</code>: Show optimization trace (Optim.jl specific)</li></ul><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>θ</code>: Optimal parameters (constrained space)</li><li><code>loglik</code>: Log-likelihood at optimum</li><li><code>result</code>: Full Optimization.jl result object</li><li><code>converged</code>: Whether optimization converged</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">spec = local_level()
y = randn(1, 100) .* 10 .+ 100

# Basic usage
result = optimize_ssm(spec, y)

println(&quot;Optimal parameters: &quot;, result.θ)
println(&quot;Log-likelihood: &quot;, result.loglik)

# With custom initial values
result2 = optimize_ssm(spec, y; θ0=(σ_obs=150.0, σ_level=50.0))

# Different optimizer with options
result3 = optimize_ssm(spec, y;
    method=Optim.Newton(),
    maxiters=500,
    show_trace=true
)

# With callback for monitoring
callback = (state, loss) -&gt; begin
    println(&quot;Iteration: loss = $loss&quot;)
    return false  # return true to stop
end
result4 = optimize_ssm(spec, y; callback=callback)

# Pass kwargs to OptimizationProblem (e.g., bounds in unconstrained space)
result5 = optimize_ssm(spec, y;
    prob_kwargs=(lb=fill(-10.0, n_params(spec)),
                 ub=fill(10.0, n_params(spec)))
)

# Disable StaticArrays (for debugging or if causing issues)
result6 = optimize_ssm(spec, y; use_static=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/optimization.jl#L16-L88">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.optimize_ssm_with_stderr"><a class="docstring-binding" href="#Filthy.DSL.optimize_ssm_with_stderr"><code>Filthy.DSL.optimize_ssm_with_stderr</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">optimize_ssm_with_stderr(spec, y; use_static=true, kwargs...)</code></pre><p>Optimize SSM and compute standard errors using the Hessian.</p><p>Returns the same as <code>optimize_ssm</code> plus:</p><ul><li><code>stderr</code>: Standard errors of parameters (in constrained space, approximate)</li><li><code>hessian</code>: Hessian matrix at the optimum (in unconstrained space)</li></ul><p>Note: Standard errors are approximate when using parameter transformations. For accurate standard errors on constrained parameters, use the delta method or bootstrap.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/optimization.jl#L134-L146">source</a></section></details></article><h2 id="Parameter-Transformations"><a class="docs-heading-anchor" href="#Parameter-Transformations">Parameter Transformations</a><a id="Parameter-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Transformations" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Filthy.DSL.build_transformation"><a class="docstring-binding" href="#Filthy.DSL.build_transformation"><code>Filthy.DSL.build_transformation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">build_transformation(spec::SSMSpec)</code></pre><p>Build a TransformVariables transformation from an SSMSpec.</p><p>Returns a transformation that maps ℝⁿ → NamedTuple with the parameter names and appropriate constraints (positive for variances, bounded for others).</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">spec = local_level()
t = build_transformation(spec)
# t transforms ℝ² → (σ_obs = ..., σ_level = ...)

θ_nt = transform(t, randn(2))
# θ_nt is a NamedTuple with positive values</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/codegen.jl#L22-L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.transform_to_constrained"><a class="docstring-binding" href="#Filthy.DSL.transform_to_constrained"><code>Filthy.DSL.transform_to_constrained</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">transform_to_constrained(spec, θ_unconstrained)</code></pre><p>Transform from unconstrained ℝⁿ to constrained parameter space. Returns (θ_constrained::NamedTuple, logjac::Real).</p><p>Uses TransformVariables.jl for the transformation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L27-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.transform_to_unconstrained"><a class="docstring-binding" href="#Filthy.DSL.transform_to_unconstrained"><code>Filthy.DSL.transform_to_unconstrained</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">transform_to_unconstrained(spec, θ_constrained::NamedTuple)</code></pre><p>Transform from constrained NamedTuple to unconstrained ℝⁿ. Inverse of <code>transform_to_constrained</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L41-L46">source</a></section><section><div><pre><code class="language-julia hljs">transform_to_unconstrained(spec, θ_constrained::AbstractVector)</code></pre><p>Transform from constrained vector to unconstrained ℝⁿ. First converts vector to NamedTuple, then inverts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L52-L57">source</a></section></details></article><h2 id="Log-Density-Interface"><a class="docs-heading-anchor" href="#Log-Density-Interface">Log-Density Interface</a><a id="Log-Density-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Log-Density-Interface" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Filthy.DSL.SSMLogDensity"><a class="docstring-binding" href="#Filthy.DSL.SSMLogDensity"><code>Filthy.DSL.SSMLogDensity</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SSMLogDensity(spec, y; prior=nothing, use_static=true)</code></pre><p>Log-density for a state-space model, evaluated in UNCONSTRAINED ℝⁿ space.</p><p>This integrates seamlessly with LogDensityProblems.jl for optimization and sampling. The transformation from unconstrained to constrained space is handled automatically using TransformVariables.jl.</p><p><strong>Fields</strong></p><ul><li><code>spec</code>: Model specification (SSMSpec)</li><li><code>transformation</code>: TransformVariables transformation (ℝⁿ → NamedTuple)</li><li><code>y</code>: Observation data (p × n matrix)</li><li><code>prior</code>: Optional prior on CONSTRAINED parameters (θ::NamedTuple -&gt; log_prior)</li><li><code>use_static</code>: Whether to use StaticArrays for small matrices (default: true)</li></ul><p><strong>Usage</strong></p><pre><code class="language-julia hljs">spec = local_level()
y = randn(1, 100)

# Create log-density (works in unconstrained space)
ld = SSMLogDensity(spec, y)

# Get initial point in unconstrained space
θ0 = transform_to_unconstrained(spec, initial_values(spec))

# Evaluate log-density
logdensity(ld, θ0)

# For optimization (in unconstrained space, no bounds needed!)
using Optim
result = optimize(θ -&gt; -logdensity(ld, θ), θ0, LBFGS())

# Transform result back to NamedTuple
θ_hat, _ = transform_to_constrained(spec, result.minimizer)
# θ_hat is a NamedTuple like (σ_obs = 12.3, σ_level = 3.4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L69-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.logdensity"><a class="docstring-binding" href="#Filthy.DSL.logdensity"><code>Filthy.DSL.logdensity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">logdensity(ld::SSMLogDensity, θ_unconstrained)</code></pre><p>Evaluate the log-density at unconstrained parameters.</p><p>Returns log p(y|θ) + log p(θ) + log|J| where J is the Jacobian of the transformation from unconstrained to constrained space.</p><p>The parameters are automatically transformed to a NamedTuple and passed to the likelihood function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L122-L132">source</a></section></details></article><h2 id="Prior-Distributions"><a class="docs-heading-anchor" href="#Prior-Distributions">Prior Distributions</a><a id="Prior-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Prior-Distributions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Filthy.DSL.FlatPrior"><a class="docstring-binding" href="#Filthy.DSL.FlatPrior"><code>Filthy.DSL.FlatPrior</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FlatPrior()</code></pre><p>Improper flat prior (log-density = 0 everywhere). Works with both Vector and NamedTuple arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L168-L173">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.NormalPrior"><a class="docstring-binding" href="#Filthy.DSL.NormalPrior"><code>Filthy.DSL.NormalPrior</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">NormalPrior(μ::NamedTuple, σ::NamedTuple)</code></pre><p>Independent normal priors for parameters, specified by name.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">prior = NormalPrior(
    (σ_obs = 10.0, σ_level = 5.0),   # means
    (σ_obs = 5.0, σ_level = 2.0)     # standard deviations
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L177-L189">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.InverseGammaPrior"><a class="docstring-binding" href="#Filthy.DSL.InverseGammaPrior"><code>Filthy.DSL.InverseGammaPrior</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">InverseGammaPrior(α, β, param_names)</code></pre><p>Inverse gamma priors for variance parameters at specified parameter names. Assumes θ contains standard deviations (will square them).</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">prior = InverseGammaPrior(2.0, 1.0, (:σ_obs, :σ_level))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L230-L240">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Filthy.DSL.CompositePrior"><a class="docstring-binding" href="#Filthy.DSL.CompositePrior"><code>Filthy.DSL.CompositePrior</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CompositePrior(priors...)</code></pre><p>Combine multiple priors by summing their log-densities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gragusa/Filthy.jl/blob/8791c67128e878be38444e198304e9edc0e1f7a0/src/dsl/bayesian.jl#L257-L261">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="matrix_helpers.html">« Matrix Helpers</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 25 December 2025 11:12">Thursday 25 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
