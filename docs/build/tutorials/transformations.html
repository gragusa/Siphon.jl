<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter Transformations · Siphon</title><meta name="title" content="Parameter Transformations · Siphon"/><meta property="og:title" content="Parameter Transformations · Siphon"/><meta property="twitter:title" content="Parameter Transformations · Siphon"/><meta name="description" content="Documentation for Siphon."/><meta property="og:description" content="Documentation for Siphon."/><meta property="twitter:description" content="Documentation for Siphon."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Siphon</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="getting_started.html">Getting Started</a></li><li><a class="tocitem" href="custom_models.html">Custom Models</a></li><li><a class="tocitem" href="dynamic_factor.html">Dynamic Factor Models</a></li><li><a class="tocitem" href="arma_models.html">ARMA Models</a></li><li><a class="tocitem" href="estimation_methods.html">Estimation Methods</a></li><li class="is-active"><a class="tocitem" href="transformations.html">Parameter Transformations</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#How-It-Works"><span>How It Works</span></a></li><li><a class="tocitem" href="#Specifying-Parameter-Bounds"><span>Specifying Parameter Bounds</span></a></li><li><a class="tocitem" href="#Working-with-Transformations-Directly"><span>Working with Transformations Directly</span></a></li><li><a class="tocitem" href="#Full-Covariance-Matrices"><span>Full Covariance Matrices</span></a></li><li><a class="tocitem" href="#Example:-Complete-Workflow"><span>Example: Complete Workflow</span></a></li><li><a class="tocitem" href="#Bayesian-Inference"><span>Bayesian Inference</span></a></li><li><a class="tocitem" href="#Tips-and-Best-Practices"><span>Tips and Best Practices</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="initial_state.html">Initial State Conventions</a></li><li><a class="tocitem" href="visualization.html">Visualization</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/core.html">Core Functions</a></li><li><a class="tocitem" href="../api/dsl.html">DSL &amp; Templates</a></li><li><a class="tocitem" href="../api/matrix_helpers.html">Matrix Helpers</a></li><li><a class="tocitem" href="../api/optimization.html">Estimation &amp; Bayesian</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="transformations.html">Parameter Transformations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="transformations.html">Parameter Transformations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gragusa/Siphon.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gragusa/Siphon.jl/blob/master/docs/src/tutorials/transformations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parameter-Transformations"><a class="docs-heading-anchor" href="#Parameter-Transformations">Parameter Transformations</a><a id="Parameter-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Transformations" title="Permalink"></a></h1><p>This tutorial explains how Siphon.jl handles parameter transformations for constrained optimization. Understanding this system is important for:</p><ul><li>Correctly specifying parameter bounds</li><li>Interpreting optimization results</li><li>Working with Bayesian inference</li><li>Implementing custom models</li></ul><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>State-space model parameters often have natural constraints:</p><ul><li><strong>Variance parameters</strong> must be positive: <span>$\sigma^2 &gt; 0$</span></li><li><strong>AR coefficients</strong> must satisfy stationarity: <span>$|\rho| &lt; 1$</span></li><li><strong>Correlation parameters</strong> must be in <span>$[-1, 1]$</span></li><li><strong>Probabilities</strong> must be in <span>$[0, 1]$</span></li></ul><p>Siphon.jl uses <a href="https://github.com/tpapp/TransformVariables.jl">TransformVariables.jl</a> to handle these constraints automatically. The key idea is to optimize in an <strong>unconstrained space</strong> <span>$\mathbb{R}^n$</span> and transform to the constrained parameter space when needed.</p><h2 id="How-It-Works"><a class="docs-heading-anchor" href="#How-It-Works">How It Works</a><a id="How-It-Works-1"></a><a class="docs-heading-anchor-permalink" href="#How-It-Works" title="Permalink"></a></h2><h3 id="The-Two-Spaces"><a class="docs-heading-anchor" href="#The-Two-Spaces">The Two Spaces</a><a id="The-Two-Spaces-1"></a><a class="docs-heading-anchor-permalink" href="#The-Two-Spaces" title="Permalink"></a></h3><ol><li><p><strong>Constrained space</strong> (<span>$\Theta$</span>): Where parameters have their natural interpretation</p><ul><li>Example: <span>$\sigma^2_{\text{obs}} = 225.0$</span> (a variance)</li></ul></li><li><p><strong>Unconstrained space</strong> (<span>$\mathbb{R}^n$</span>): Where optimization actually happens</p><ul><li>Example: <span>$\theta_{\text{unconstrained}} = 5.42$</span> (the log of <span>$\sigma^2$</span>)</li></ul></li></ol><h3 id="Transformation-Flow"><a class="docs-heading-anchor" href="#Transformation-Flow">Transformation Flow</a><a id="Transformation-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-Flow" title="Permalink"></a></h3><pre><code class="nohighlight hljs">                    transform
Unconstrained θ_u ─────────────&gt; Constrained θ_c (NamedTuple)
      ℝⁿ           (+ logjac)          Θ
                                       │
                                       ▼
                              Build state-space matrices
                                       │
                                       ▼
                              Compute log-likelihood</code></pre><p>The optimizer works in unconstrained space. For each evaluation:</p><ol><li>Transform <span>$\theta_u \to \theta_c$</span> (unconstrained to constrained)</li><li>Build state-space matrices using <span>$\theta_c$</span></li><li>Compute log-likelihood</li><li>(For Bayesian: add log Jacobian and log prior)</li></ol><h2 id="Specifying-Parameter-Bounds"><a class="docs-heading-anchor" href="#Specifying-Parameter-Bounds">Specifying Parameter Bounds</a><a id="Specifying-Parameter-Bounds-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-Parameter-Bounds" title="Permalink"></a></h2><p>When you create a <code>FreeParam</code>, the bounds determine which transformation is applied:</p><pre><code class="language-julia hljs"># Positive parameter (variance) - uses exp transform
FreeParam(:var_obs, init=100.0, lower=0.0)

# Bounded parameter (AR coefficient) - uses logit-like transform
FreeParam(:ρ, init=0.8, lower=-0.99, upper=0.99)

# Unbounded parameter - identity (no transform)
FreeParam(:β, init=0.0)</code></pre><h3 id="Transformation-Rules"><a class="docs-heading-anchor" href="#Transformation-Rules">Transformation Rules</a><a id="Transformation-Rules-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-Rules" title="Permalink"></a></h3><table><tr><th style="text-align: right">Bounds</th><th style="text-align: right">Transform</th><th style="text-align: right">Mathematical Form</th></tr><tr><td style="text-align: right"><span>$(-\infty, \infty)$</span></td><td style="text-align: right">Identity</td><td style="text-align: right"><span>$\theta_c = \theta_u$</span></td></tr><tr><td style="text-align: right"><span>$[0, \infty)$</span></td><td style="text-align: right">Exponential</td><td style="text-align: right"><span>$\theta_c = \exp(\theta_u)$</span></td></tr><tr><td style="text-align: right"><span>$(a, b)$</span></td><td style="text-align: right">Scaled logistic</td><td style="text-align: right"><span>$\theta_c = a + (b-a) \cdot \text{logistic}(\theta_u)$</span></td></tr><tr><td style="text-align: right"><span>$(-\infty, b]$</span></td><td style="text-align: right">Negative exp</td><td style="text-align: right"><span>$\theta_c = b - \exp(-\theta_u)$</span></td></tr></table><h3 id="For-Variance-Parameters"><a class="docs-heading-anchor" href="#For-Variance-Parameters">For Variance Parameters</a><a id="For-Variance-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#For-Variance-Parameters" title="Permalink"></a></h3><p>Use <code>lower=0.0</code> to ensure positivity:</p><pre><code class="language-julia hljs"># Correct: estimate variance directly with positivity constraint
H = [FreeParam(:var_obs, init=100.0, lower=0.0)]</code></pre><p>The transformation automatically applied is:</p><p class="math-container">\[\sigma^2 = \exp(\theta_u)\]</p><p>So if the optimizer finds <span>$\theta_u = 4.6$</span>, you get <span>$\sigma^2 = \exp(4.6) \approx 100$</span>.</p><h2 id="Working-with-Transformations-Directly"><a class="docs-heading-anchor" href="#Working-with-Transformations-Directly">Working with Transformations Directly</a><a id="Working-with-Transformations-Directly-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-Transformations-Directly" title="Permalink"></a></h2><h3 id="Building-Transformations"><a class="docs-heading-anchor" href="#Building-Transformations">Building Transformations</a><a id="Building-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Building-Transformations" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Siphon

spec = local_level()
t = build_transformation(spec)

# Transform from unconstrained to constrained
θ_u = [4.6, 3.9]  # Unconstrained values
θ_c = TransformVariables.transform(t, θ_u)
# θ_c = (var_obs = 99.5, var_level = 49.4)</code></pre><h3 id="Transform-with-Jacobian"><a class="docs-heading-anchor" href="#Transform-with-Jacobian">Transform with Jacobian</a><a id="Transform-with-Jacobian-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-with-Jacobian" title="Permalink"></a></h3><p>For Bayesian inference, you need the log Jacobian determinant:</p><pre><code class="language-julia hljs">using TransformVariables

θ_c, logjac = transform_and_logjac(t, θ_u)
# logjac accounts for the change of variables</code></pre><h3 id="Inverse-Transform"><a class="docs-heading-anchor" href="#Inverse-Transform">Inverse Transform</a><a id="Inverse-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Inverse-Transform" title="Permalink"></a></h3><p>To go from constrained back to unconstrained:</p><pre><code class="language-julia hljs">θ_u = transform_to_unconstrained(spec, θ_c)</code></pre><h2 id="Full-Covariance-Matrices"><a class="docs-heading-anchor" href="#Full-Covariance-Matrices">Full Covariance Matrices</a><a id="Full-Covariance-Matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Covariance-Matrices" title="Permalink"></a></h2><p>For full positive-definite covariance matrices, Siphon.jl uses a special parameterization via <code>cov_free</code>:</p><pre><code class="language-julia hljs">Q = cov_free(2, :Q)  # 2×2 PD covariance matrix</code></pre><p>This creates:</p><ul><li><strong>Standard deviation parameters</strong>: <code>Q_σ_1</code>, <code>Q_σ_2</code> (positive, use exp transform)</li><li><strong>Correlation parameters</strong>: <code>Q_corr_1</code> (unconstrained, maps to valid correlation)</li></ul><p>The matrix is reconstructed as:</p><p class="math-container">\[\Sigma = D \cdot \text{Corr} \cdot D\]</p><p>where <span>$D = \text{diag}(\sigma_1, \sigma_2)$</span> and <span>$\text{Corr}$</span> is built from a Cholesky factor parameterization that guarantees positive definiteness.</p><h2 id="Example:-Complete-Workflow"><a class="docs-heading-anchor" href="#Example:-Complete-Workflow">Example: Complete Workflow</a><a id="Example:-Complete-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Complete-Workflow" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Siphon

# Specify model with constrained parameters
spec = custom_ssm(
    Z = [1.0],
    H = [FreeParam(:var_obs, init=100.0, lower=0.0)],  # Positive
    T = [FreeParam(:ρ, init=0.8, lower=-0.99, upper=0.99)],  # Bounded
    R = [1.0],
    Q = [FreeParam(:var_state, init=50.0, lower=0.0)],  # Positive
    a1 = [0.0],
    P1 = [1e7]
)

# Simulate data
y = randn(1, 200)

# Optimize - all transformation handled automatically
result = optimize_ssm(spec, y)

# Result is in constrained space
println(&quot;var_obs = &quot;, result.θ.var_obs)    # Positive value
println(&quot;ρ = &quot;, result.θ.ρ)                # In (-0.99, 0.99)
println(&quot;var_state = &quot;, result.θ.var_state)  # Positive value

# If you need unconstrained values (e.g., for MCMC initialization)
θ_u = transform_to_unconstrained(spec, result.θ)
println(&quot;Unconstrained: &quot;, θ_u)  # Values in ℝ³</code></pre><h2 id="Bayesian-Inference"><a class="docs-heading-anchor" href="#Bayesian-Inference">Bayesian Inference</a><a id="Bayesian-Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Inference" title="Permalink"></a></h2><p>For Bayesian inference with MCMC, the log-density is computed in unconstrained space:</p><pre><code class="language-julia hljs"># Create log-density object
ld = SSMLogDensity(spec, y)

# Evaluate at unconstrained point
θ_u = randn(n_params(spec))
ll = logdensity(ld, θ_u)
# ll includes the log Jacobian automatically</code></pre><p>The <code>SSMLogDensity</code> type implements <code>LogDensityProblems.jl</code> interface, so you can use it with any compatible sampler.</p><h2 id="Tips-and-Best-Practices"><a class="docs-heading-anchor" href="#Tips-and-Best-Practices">Tips and Best Practices</a><a id="Tips-and-Best-Practices-1"></a><a class="docs-heading-anchor-permalink" href="#Tips-and-Best-Practices" title="Permalink"></a></h2><ol><li><p><strong>Always use <code>lower=0.0</code> for variances</strong>: This ensures the exp transform is applied.</p></li><li><p><strong>Use tight bounds for AR coefficients</strong>: <code>lower=-0.99, upper=0.99</code> works better than <code>(-1, 1)</code> numerically.</p></li><li><p><strong>Initial values matter</strong>: Provide good initial values in the constrained space. They are automatically transformed.</p></li><li><p><strong>Standard errors are approximate</strong>: When using <code>optimize_ssm_with_stderr</code>, the standard errors are computed via the delta method and may be approximate for highly nonlinear transformations.</p></li><li><p><strong>For debugging</strong>: Use <code>transform_to_unconstrained</code> and <code>transform_to_constrained</code> to verify parameter values at each stage.</p></li></ol><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><h3 id="Key-Functions"><a class="docs-heading-anchor" href="#Key-Functions">Key Functions</a><a id="Key-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Functions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Build transformation from spec
t = build_transformation(spec)

# Transform unconstrained → constrained
θ_c, logjac = transform_to_constrained(spec, θ_u)

# Transform constrained → unconstrained
θ_u = transform_to_unconstrained(spec, θ_c)</code></pre><h3 id="Related-Types"><a class="docs-heading-anchor" href="#Related-Types">Related Types</a><a id="Related-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Related-Types" title="Permalink"></a></h3><ul><li><code>FreeParam</code>: Specify a free parameter with bounds</li><li><code>SSMLogDensity</code>: Log-density in unconstrained space</li><li><code>CovMatrixExpr</code>: Expression for positive-definite covariance matrices</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="estimation_methods.html">« Estimation Methods</a><a class="docs-footer-nextpage" href="initial_state.html">Initial State Conventions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 25 January 2026 19:05">Sunday 25 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
