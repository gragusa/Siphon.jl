<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Visualization · Siphon</title><meta name="title" content="Visualization · Siphon"/><meta property="og:title" content="Visualization · Siphon"/><meta property="twitter:title" content="Visualization · Siphon"/><meta name="description" content="Documentation for Siphon."/><meta property="og:description" content="Documentation for Siphon."/><meta property="twitter:description" content="Documentation for Siphon."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Siphon</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="getting_started.html">Getting Started</a></li><li><a class="tocitem" href="custom_models.html">Custom Models</a></li><li><a class="tocitem" href="dynamic_factor.html">Dynamic Factor Models</a></li><li><a class="tocitem" href="arma_models.html">ARMA Models</a></li><li><a class="tocitem" href="estimation_methods.html">Estimation Methods</a></li><li><a class="tocitem" href="transformations.html">Parameter Transformations</a></li><li><a class="tocitem" href="initial_state.html">Initial State Conventions</a></li><li class="is-active"><a class="tocitem" href="visualization.html">Visualization</a><ul class="internal"><li><a class="tocitem" href="#Quick-Start-(Recommended:-KalmanWorkspace)"><span>Quick Start (Recommended: KalmanWorkspace)</span></a></li><li><a class="tocitem" href="#Plotting-with-KalmanWorkspace"><span>Plotting with KalmanWorkspace</span></a></li><li><a class="tocitem" href="#Functional-API-(Alternative)"><span>Functional API (Alternative)</span></a></li><li><a class="tocitem" href="#Plotting-Smoothed-States"><span>Plotting Smoothed States</span></a></li><li><a class="tocitem" href="#Plotting-Forecasts"><span>Plotting Forecasts</span></a></li><li><a class="tocitem" href="#Comparing-Filtered-vs-Smoothed"><span>Comparing Filtered vs Smoothed</span></a></li><li><a class="tocitem" href="#Plotting-Observable-Predictions"><span>Plotting Observable Predictions</span></a></li><li><a class="tocitem" href="#Complete-Example:-Nile-River-Flow"><span>Complete Example: Nile River Flow</span></a></li><li><a class="tocitem" href="#Customizing-Plots"><span>Customizing Plots</span></a></li><li><a class="tocitem" href="#Color-Scheme"><span>Color Scheme</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/core.html">Core Functions</a></li><li><a class="tocitem" href="../api/dsl.html">DSL &amp; Templates</a></li><li><a class="tocitem" href="../api/matrix_helpers.html">Matrix Helpers</a></li><li><a class="tocitem" href="../api/optimization.html">Estimation &amp; Bayesian</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="visualization.html">Visualization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="visualization.html">Visualization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gragusa/Siphon.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gragusa/Siphon.jl/blob/master/docs/src/tutorials/visualization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h1><p>Siphon.jl provides plotting recipes via <a href="https://github.com/JuliaPlots/RecipesBase.jl">RecipesBase.jl</a> for visualizing Kalman filter and smoother outputs with confidence bands. These recipes work with any Plots.jl backend.</p><h2 id="Quick-Start-(Recommended:-KalmanWorkspace)"><a class="docs-heading-anchor" href="#Quick-Start-(Recommended:-KalmanWorkspace)">Quick Start (Recommended: KalmanWorkspace)</a><a id="Quick-Start-(Recommended:-KalmanWorkspace)-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start-(Recommended:-KalmanWorkspace)" title="Permalink"></a></h2><p>The recommended approach uses <code>KalmanWorkspace</code> for zero-allocation, in-place computation:</p><pre><code class="language-julia hljs">using Plots
using Siphon

# Create workspace and run filter + smoother
ws = KalmanWorkspace(Z, H, T, R, Q, a1, P1, n)
kalman_filter!(ws, y)
kalman_smoother!(ws)

# Plot smoothed states with 95% confidence bands
plot(ws)</code></pre><h2 id="Plotting-with-KalmanWorkspace"><a class="docs-heading-anchor" href="#Plotting-with-KalmanWorkspace">Plotting with KalmanWorkspace</a><a id="Plotting-with-KalmanWorkspace-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-with-KalmanWorkspace" title="Permalink"></a></h2><p>The <code>KalmanWorkspace</code> recipe is the primary plotting interface. It supports filtered, predicted, and smoothed states:</p><pre><code class="language-julia hljs"># Create and run
ws = KalmanWorkspace(Z, H, T, R, Q, a1, P1, n)
kalman_filter!(ws, y)
kalman_smoother!(ws)

# Plot smoothed states (default)
plot(ws)
plot(ws, what=:smoothed)

# Plot filtered or predicted states
plot(ws, what=:filtered)
plot(ws, what=:predicted)

# Customize
plot(ws, vars=1, level=0.90)     # Single state with 90% CI
plot(ws, vars=[1,3])             # Multiple states
plot(ws, band=false)             # No confidence bands
plot(ws, time=dates)             # Custom time axis</code></pre><h3 id="Keywords"><a class="docs-heading-anchor" href="#Keywords">Keywords</a><a id="Keywords-1"></a><a class="docs-heading-anchor-permalink" href="#Keywords" title="Permalink"></a></h3><table><tr><th style="text-align: right">Keyword</th><th style="text-align: right">Default</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>vars</code></td><td style="text-align: right"><code>:all</code></td><td style="text-align: right">Variables to plot: Int, Vector, Range, or <code>:all</code></td></tr><tr><td style="text-align: right"><code>level</code></td><td style="text-align: right"><code>0.95</code></td><td style="text-align: right">Confidence level for bands (0 &lt; level &lt; 1)</td></tr><tr><td style="text-align: right"><code>what</code></td><td style="text-align: right"><code>:smoothed</code></td><td style="text-align: right">State type: <code>:smoothed</code>, <code>:filtered</code>, or <code>:predicted</code></td></tr><tr><td style="text-align: right"><code>band</code></td><td style="text-align: right"><code>true</code></td><td style="text-align: right">Whether to show confidence bands</td></tr><tr><td style="text-align: right"><code>time</code></td><td style="text-align: right"><code>nothing</code></td><td style="text-align: right">Custom time axis (default: 1:n)</td></tr></table><h2 id="Functional-API-(Alternative)"><a class="docs-heading-anchor" href="#Functional-API-(Alternative)">Functional API (Alternative)</a><a id="Functional-API-(Alternative)-1"></a><a class="docs-heading-anchor-permalink" href="#Functional-API-(Alternative)" title="Permalink"></a></h2><p>For simpler cases or when AD compatibility is needed, you can use the functional API:</p><pre><code class="language-julia hljs"># Define model and run filter
p = KFParms(Z, H, T, R, Q)
result = kalman_filter(p, y, a1, P1)

# Plot filtered states with 95% confidence bands
plot(result)
plot(result, vars=1)             # State 1 only
plot(result, vars=[1,3])         # States 1 and 3
plot(result, level=0.90)         # 90% CI
plot(result, band=false)         # No confidence bands
plot(result, filtered=false)     # Predicted states instead of filtered</code></pre><h2 id="Plotting-Smoothed-States"><a class="docs-heading-anchor" href="#Plotting-Smoothed-States">Plotting Smoothed States</a><a id="Plotting-Smoothed-States-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Smoothed-States" title="Permalink"></a></h2><p>The <code>SmootherResult</code> wrapper enables plotting smoothed states from any source:</p><pre><code class="language-julia hljs"># Method 1: From KalmanWorkspace (recommended)
ws = KalmanWorkspace(Z, H, T, R, Q, a1, P1, n)
kalman_filter!(ws, y)
kalman_smoother!(ws)
smooth = SmootherResult(ws)
plot(smooth)

# Method 2: Convenience constructor (runs filter + smoother internally)
p = KFParms(Z, H, T, R, Q)
smooth = SmootherResult(p, y, a1, P1)
plot(smooth, vars=1, level=0.90)

# Method 3: Wrap existing smoother NamedTuple output
filt = kalman_filter(p, y, a1, P1)
nt = kalman_smoother(p.Z, p.T, filt.at, filt.Pt, filt.vt, filt.Ft)
smooth = SmootherResult(nt)
plot(smooth)</code></pre><h3 id="Keywords-2"><a class="docs-heading-anchor" href="#Keywords-2">Keywords</a><a class="docs-heading-anchor-permalink" href="#Keywords-2" title="Permalink"></a></h3><table><tr><th style="text-align: right">Keyword</th><th style="text-align: right">Default</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>vars</code></td><td style="text-align: right"><code>:all</code></td><td style="text-align: right">Variables to plot</td></tr><tr><td style="text-align: right"><code>level</code></td><td style="text-align: right"><code>0.95</code></td><td style="text-align: right">Confidence level for bands</td></tr><tr><td style="text-align: right"><code>band</code></td><td style="text-align: right"><code>true</code></td><td style="text-align: right">Whether to show confidence bands</td></tr></table><h2 id="Plotting-Forecasts"><a class="docs-heading-anchor" href="#Plotting-Forecasts">Plotting Forecasts</a><a id="Plotting-Forecasts-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Forecasts" title="Permalink"></a></h2><p>Wrap forecast output in <code>ForecastResult</code>:</p><pre><code class="language-julia hljs"># Run forecast
fc_nt = forecast(spec, θ, y, 24)  # 24-step ahead forecast
fc = ForecastResult(fc_nt)

# Plot forecasted observations (default)
plot(fc)
plot(fc, what=:observations)

# Plot forecasted states
plot(fc, what=:states)
plot(fc, what=:states, vars=1)</code></pre><h3 id="Keywords-3"><a class="docs-heading-anchor" href="#Keywords-3">Keywords</a><a class="docs-heading-anchor-permalink" href="#Keywords-3" title="Permalink"></a></h3><table><tr><th style="text-align: right">Keyword</th><th style="text-align: right">Default</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>vars</code></td><td style="text-align: right"><code>:all</code></td><td style="text-align: right">Variables to plot</td></tr><tr><td style="text-align: right"><code>level</code></td><td style="text-align: right"><code>0.95</code></td><td style="text-align: right">Confidence level for bands</td></tr><tr><td style="text-align: right"><code>what</code></td><td style="text-align: right"><code>:observations</code></td><td style="text-align: right">Plot <code>:observations</code> or <code>:states</code></td></tr><tr><td style="text-align: right"><code>band</code></td><td style="text-align: right"><code>true</code></td><td style="text-align: right">Whether to show confidence bands</td></tr></table><h2 id="Comparing-Filtered-vs-Smoothed"><a class="docs-heading-anchor" href="#Comparing-Filtered-vs-Smoothed">Comparing Filtered vs Smoothed</a><a id="Comparing-Filtered-vs-Smoothed-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-Filtered-vs-Smoothed" title="Permalink"></a></h2><p>Plot both filtered and smoothed states together:</p><pre><code class="language-julia hljs">result = kalman_filter(p, y, a1, P1)
smooth = SmootherResult(p, y, a1, P1)

# Compare on same plot
plot((result, smooth), vars=1)
plot((result, smooth), vars=[1,2], band=true)</code></pre><p>The comparison shows filtered states as dashed blue lines and smoothed states as solid green lines, with optional confidence bands around the smoother.</p><h2 id="Plotting-Observable-Predictions"><a class="docs-heading-anchor" href="#Plotting-Observable-Predictions">Plotting Observable Predictions</a><a id="Plotting-Observable-Predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Observable-Predictions" title="Permalink"></a></h2><p>Plot one-step-ahead predictions of observables (y<em>hat</em>t = Z * a_t):</p><pre><code class="language-julia hljs">result = kalman_filter(p, y, a1, P1)

# One-step-ahead predictions
plot(result, ObservablePlot)

# With actual observations overlay
plot(result, ObservablePlot, actual=y)

# Select specific observables
plot(result, ObservablePlot, vars=1, level=0.90)</code></pre><h2 id="Complete-Example:-Nile-River-Flow"><a class="docs-heading-anchor" href="#Complete-Example:-Nile-River-Flow">Complete Example: Nile River Flow</a><a id="Complete-Example:-Nile-River-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Example:-Nile-River-Flow" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Plots
using Siphon
using DelimitedFiles

# Load Nile data
nile = readdlm(&quot;Nile.csv&quot;, &#39;,&#39;, Float64)
y = reshape(nile[:, 1], 1, :)
n = size(y, 2)

# Local level model parameters (MLE estimates)
Z = [1.0;;]       # Observation matrix
H = [15099.0;;]   # Observation variance
T = [1.0;;]       # Transition matrix
R = [1.0;;]       # Selection matrix
Q = [1469.0;;]    # State variance
a1 = [0.0]        # Initial state mean
P1 = [1e7;;]      # Initial state variance (diffuse)

# Create workspace and run filter + smoother
ws = KalmanWorkspace(Z, H, T, R, Q, a1, P1, n)
kalman_filter!(ws, y)
kalman_smoother!(ws)

# Plot smoothed states (recommended)
p1 = plot(ws, what=:smoothed, title=&quot;Smoothed Level&quot;,
          xlabel=&quot;Year&quot;, ylabel=&quot;Flow&quot;)

# Plot filtered states
p2 = plot(ws, what=:filtered, title=&quot;Filtered Level&quot;,
          xlabel=&quot;Year&quot;, ylabel=&quot;Flow&quot;)

# Plot predicted states
p3 = plot(ws, what=:predicted, title=&quot;Predicted Level&quot;,
          xlabel=&quot;Year&quot;, ylabel=&quot;Flow&quot;)

# For comparison with functional API
result = kalman_filter(KFParms(Z, H, T, R, Q), y, a1, P1)
smooth = SmootherResult(ws)  # Create from workspace

# Compare filtered vs smoothed
p4 = plot((result, smooth), title=&quot;Filtered vs Smoothed&quot;,
          xlabel=&quot;Year&quot;, ylabel=&quot;Flow&quot;)

# Observable predictions with actual data
p5 = plot(result, ObservablePlot, actual=y,
          title=&quot;One-Step-Ahead Predictions&quot;,
          xlabel=&quot;Year&quot;, ylabel=&quot;Flow&quot;)

# Combine into single figure
plot(p1, p2, p4, p5, layout=(2,2), size=(1000, 800))</code></pre><h2 id="Customizing-Plots"><a class="docs-heading-anchor" href="#Customizing-Plots">Customizing Plots</a><a id="Customizing-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Customizing-Plots" title="Permalink"></a></h2><p>Since recipes use RecipesBase.jl, you can combine them with standard Plots.jl attributes:</p><pre><code class="language-julia hljs">plot(result,
    vars=1,
    level=0.95,
    title=&quot;Custom Title&quot;,
    xlabel=&quot;Time&quot;,
    ylabel=&quot;Value&quot;,
    linewidth=3,
    legend=:bottomright,
    size=(800, 400)
)</code></pre><h2 id="Color-Scheme"><a class="docs-heading-anchor" href="#Color-Scheme">Color Scheme</a><a id="Color-Scheme-1"></a><a class="docs-heading-anchor-permalink" href="#Color-Scheme" title="Permalink"></a></h2><p>The default color scheme uses consistent colors across plot types:</p><ul><li><strong>Filtered states</strong>: Steel blue (line) with light blue (bands)</li><li><strong>Smoothed states</strong>: Dark green (line) with light green (bands)</li><li><strong>Forecasts</strong>: Dark orange (dashed line) with light orange (bands)</li><li><strong>Predicted states</strong>: Purple (line) with light purple (bands)</li></ul><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><h3 id="Core-Types"><a class="docs-heading-anchor" href="#Core-Types">Core Types</a><a id="Core-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Types" title="Permalink"></a></h3><ul><li><code>KalmanWorkspace</code>: In-place filter/smoother workspace (recommended)</li><li><code>KalmanFilterResult</code>: Functional API filter output</li><li><code>SmootherResult</code>: Wrapper for smoother output</li><li><code>ForecastResult</code>: Wrapper for forecast output</li><li><code>ObservablePlot</code>: Marker type for observable prediction plots</li></ul><h3 id="In-place-Functions"><a class="docs-heading-anchor" href="#In-place-Functions">In-place Functions</a><a id="In-place-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#In-place-Functions" title="Permalink"></a></h3><ul><li><code>kalman_filter!</code>: Run filter in-place</li><li><code>kalman_smoother!</code>: Run smoother in-place</li><li><code>filter_and_smooth!</code>: Run both in-place</li></ul><h3 id="Accessor-Functions"><a class="docs-heading-anchor" href="#Accessor-Functions">Accessor Functions</a><a id="Accessor-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Accessor-Functions" title="Permalink"></a></h3><ul><li><code>smoothed_states</code>: Get smoothed state means</li><li><code>filtered_states</code>: Get filtered state means</li><li><code>predicted_states</code>: Get predicted state means</li><li><code>variances_smoothed_states</code>: Get smoothed state covariances</li><li><code>loglikelihood</code>: Get log-likelihood</li></ul><h3 id="Helper-Functions"><a class="docs-heading-anchor" href="#Helper-Functions">Helper Functions</a><a id="Helper-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-Functions" title="Permalink"></a></h3><ul><li><code>confidence_bands</code>: Compute confidence interval bounds</li><li><code>select_vars</code>: Parse variable selection keywords</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="initial_state.html">« Initial State Conventions</a><a class="docs-footer-nextpage" href="../api/core.html">Core Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 25 January 2026 19:05">Sunday 25 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
